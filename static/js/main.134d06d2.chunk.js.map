{"version":3,"sources":["ErrorBoundary.js","api/apiContext.js","api/APIProvider.js","styles.js","search/CityInput.js","search/SearchForm.js","search/UserInfo.js","search/TripCard.js","search/SearchResults.js","search/searchTrips.js","search/Search.js","api/useAPI.js","App/App.js","App/index.js","index.js"],"names":["ErrorBoundary","state","error","info","console","this","props","children","React","Component","API_CONTEXT","createContext","LOCAL_STORAGE_KEY_TOKEN","AUTH_FETCH_OPTIONS","method","headers","body","JSON","stringify","grant_type","client_id","process","client_secret","scopes","APIProvider","token","useRef","localStorage","getItem","getToken","useCallback","a","async","fetch","result","ok","Error","statusText","status","json","current","access_token","setItem","fetchAPI","input","fetchWithToken","init","Authorization","value","useMemo","Provider","NONE_OPTION_VALUE","CITIES","Select","styled","select","SPACING_UNIT","CityInput","onChange","rest","e","target","map","city","key","Form","section","Field","div","Label","label","SearchForm","departure","setDeparture","destination","setDestination","htmlFor","id","UserInfoWrapper","Avatar","img","UserInfo","user","href","links","_front","rel","has_picture","src","picture","alt","display_name","TODAY","Date","DATE_API_FORMAT","TIME_FORMAT","DAY_FORMAT","Card","CardContent","CardFooter","DepartureDate","span","TripInfo","Price","TripCard","trip","departureDate","parse","departure_date","formattedDepartureTime","format","isSameDay","day","departure_place","city_name","arrival_place","price","string_value","Results","ul","ResultsCount","p","SearchResults","results","pager","trips","total","permanent_id","DEFAULT_SEARCH_QUERIES","_format","locale","cur","DEFAULT_SEARCH_OPTIONS","Accept","searchTrips","query","fn","tn","Separator","hr","Helper","Placeholder","Search","context","useContext","useAPI","useState","useAsyncMemo","searchStatus","content","message","pending","GlobalStyles","createGlobalStyle","AppWrapper","main","Title","h1","App","global","APP_VERSION","APP_NAME","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.134d06d2.chunk.js","sourcesContent":["import React from 'react';\n\nexport class ErrorBoundary extends React.Component {\n  state = { error: false };\n\n  static getDerivedStateFromError() {\n    return { error: true };\n  }\n\n  componentDidCatch(error, info) {\n    // The error could also be sent to an error tracker like Sentry.\n    console.error(error);\n    console.error(info);\n  }\n\n  render() {\n    if (this.state.error) {\n      return <p>Oups something went wrong</p>;\n    }\n\n    return this.props.children;\n  }\n}\n","import React from 'react';\n\n/**\n * This context provides a fetch function that manages the API token so callers\n * don't have to.\n *\n * @typedef {object} APIContextValue\n * @property {function(RequestInfo, RequestInit): Promise<Response>} fetchAPI\n */\n\n/** @type {React.Context<APIContextValue>} */\nexport const API_CONTEXT = React.createContext(null);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { API_CONTEXT } from './apiContext';\n\nexport const LOCAL_STORAGE_KEY_TOKEN = 'token';\n\nconst AUTH_FETCH_OPTIONS = {\n  method: 'post',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    grant_type: 'client_credentials',\n    client_id: process.env.REACT_APP_CLIENT_ID,\n    client_secret: process.env.REACT_APP_CLIENT_SECRET,\n    scopes: ['SCOPE_TRIP_DRIVER', 'DEFAULT', 'SCOPE_INTERNAL_CLIENT'],\n  }),\n};\n\nexport function APIProvider({ children }) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (\n      process.env.REACT_APP_CLIENT_ID == null ||\n      process.env.REACT_APP_CLIENT_SECRET == null\n    ) {\n      throw new Error(\n        'The authentication API requires a client ID and secret. Have a look at the Set up authentication keys section in the README.',\n      );\n    }\n  }\n\n  // Use a Ref instead of a state to avoid updates and to make sure the\n  // references of `getToken` and `fetchAPI` never change.\n  const token = React.useRef(localStorage.getItem(LOCAL_STORAGE_KEY_TOKEN));\n\n  // Gets a new token and save it for later in the local storage.\n  const getToken = React.useCallback(async () => {\n    const result = await fetch(\n      process.env.REACT_APP_AUTH_API,\n      AUTH_FETCH_OPTIONS,\n    );\n\n    if (!result.ok) {\n      throw new Error(\n        `Could not get token: ${result.statusText || result.status}`,\n      );\n    }\n\n    token.current = (await result.json()).access_token;\n    localStorage.setItem(LOCAL_STORAGE_KEY_TOKEN, token.current);\n  }, []);\n\n  // The fetch wrapper that adds the API token and update the token when needed.\n  const fetchAPI = React.useCallback(\n    async (input, { headers = {}, ...init } = {}) => {\n      // The actual API call.\n      async function fetchWithToken() {\n        return await fetch(input, {\n          ...init,\n          headers: { ...headers, Authorization: `Bearer ${token.current}` },\n        });\n      }\n\n      let result = null;\n\n      // Optimistic API call with the current token.\n      if (token.current != null) {\n        result = await fetchWithToken();\n      }\n\n      // When the token is missing or expired, we ask for a new one and retry\n      // the API call.\n      // We only ask for a token when we need one, i.e. when an API call is\n      // made.\n      if (token.current == null || result.status === 401) {\n        await getToken();\n        result = await fetchWithToken();\n      }\n\n      return result;\n    },\n    [getToken],\n  );\n\n  const value = React.useMemo(() => ({ fetchAPI }), [fetchAPI]);\n\n  return <API_CONTEXT.Provider value={value} children={children} />;\n}\n\nAPIProvider.propTypes = {\n  children: PropTypes.node,\n};\n","export const SPACING_UNIT = 0.5;\nexport const CHILDREN_SPACING_SELECTOR = '& > *:not(:first-child)';\nexport const PRIMARY_TEXT_COLOR = '#333';\nexport const SECONDARY_TEXT_COLOR = '#555';\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport { SPACING_UNIT } from '../styles';\n\n// The value corresponding to the \"Select a city...\" option.\nconst NONE_OPTION_VALUE = 'none';\n\n// It would be better to dynamically fetch this list.\nconst CITIES = [\n  'Paris',\n  'Lyon',\n  'Marseille',\n  'Rennes',\n  'Bordeaux',\n  'Lille',\n  'Nantes',\n];\n\nconst Select = styled.select`\n  height: 2em;\n  border: 1px solid #ccc;\n  border-radius: ${SPACING_UNIT / 2}em;\n  background: white;\n  color: inherit;\n  font: inherit;\n  cursor: pointer;\n`;\n\n// We use a native select here to simplify things.\n// It would be better to use a custum select that let the user searches for a\n// city, the list could come from an API.\nexport function CityInput({ value, onChange, ...rest }) {\n  return (\n    <Select\n      {...rest}\n      value={value || NONE_OPTION_VALUE}\n      onChange={e => {\n        onChange(e.target.value === NONE_OPTION_VALUE ? '' : e.target.value);\n      }}\n    >\n      <option value={NONE_OPTION_VALUE}>Select a city...</option>\n\n      {CITIES.map(city => (\n        <option key={city} value={city} children={city} />\n      ))}\n    </Select>\n  );\n}\n\nCityInput.propTypes = {\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport {\n  CHILDREN_SPACING_SELECTOR,\n  SECONDARY_TEXT_COLOR,\n  SPACING_UNIT,\n} from '../styles';\nimport { CityInput } from './CityInput';\n\nconst Form = styled.section`\n  display: flex;\n  align-items: center;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-left: ${SPACING_UNIT * 2}em;\n  }\n`;\n\nconst Field = styled.div`\n  min-width: 0;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-top: ${SPACING_UNIT}em;\n  }\n`;\n\nconst Label = styled.label`\n  color: ${SECONDARY_TEXT_COLOR};\n`;\n\nexport function SearchForm({\n  departure,\n  setDeparture,\n  destination,\n  setDestination,\n}) {\n  return (\n    <Form>\n      <Field>\n        <Label htmlFor=\"departure\">Departure</Label>\n        <CityInput id=\"departure\" value={departure} onChange={setDeparture} />\n      </Field>\n\n      <Field>\n        <Label htmlFor=\"destination\">Destination</Label>\n        <CityInput\n          id=\"destination\"\n          value={destination}\n          onChange={setDestination}\n        />\n      </Field>\n    </Form>\n  );\n}\n\nSearchForm.propTypes = {\n  departure: PropTypes.string.isRequired,\n  setDeparture: PropTypes.func.isRequired,\n  destination: PropTypes.string.isRequired,\n  setDestination: PropTypes.func.isRequired,\n};\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport { CHILDREN_SPACING_SELECTOR, SPACING_UNIT } from '../styles';\n\nconst UserInfoWrapper = styled.a`\n  display: inline-flex;\n  align-items: center;\n  color: inherit;\n  text-decoration: none;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-left: ${SPACING_UNIT}em;\n  }\n`;\n\nconst Avatar = styled.img`\n  width: 2em;\n  height: 2em;\n  object-fit: contain;\n  border-radius: 50%;\n`;\n\nexport function UserInfo({ user }) {\n  return (\n    <UserInfoWrapper\n      href={user.links._front}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n    >\n      {user.has_picture && (\n        <Avatar src={user.picture} alt={user.display_name} />\n      )}\n\n      <span>{user.display_name}</span>\n    </UserInfoWrapper>\n  );\n}\n\nUserInfo.propTypes = {\n  user: PropTypes.shape({\n    links: PropTypes.shape({\n      _front: PropTypes.string.isRequired,\n    }).isRequired,\n    has_picture: PropTypes.bool.isRequired,\n    picture: PropTypes.string,\n    display_name: PropTypes.string,\n  }).isRequired,\n};\n","import { format, isSameDay, parse } from 'date-fns';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport { CHILDREN_SPACING_SELECTOR, SPACING_UNIT } from '../styles';\nimport { UserInfo } from './UserInfo';\n\nconst TODAY = new Date();\n\nconst DATE_API_FORMAT = 'dd/MM/yyyy HH:mm:ss';\nconst TIME_FORMAT = 'HH:mm';\nconst DAY_FORMAT = 'EEEE do';\n\nconst Card = styled.div`\n  padding: ${SPACING_UNIT * 2}em;\n  background-color: white;\n  box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.23);\n  border-radius: ${SPACING_UNIT / 2}em;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-top: ${SPACING_UNIT * 2}em;\n  }\n`;\n\nconst CardContent = styled.div`\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-left: ${SPACING_UNIT}em;\n  }\n`;\n\nconst CardFooter = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-left: ${SPACING_UNIT}em;\n  }\n`;\n\nconst DepartureDate = styled.span`\n  font-size: 1.25em;\n`;\n\nconst TripInfo = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-top: ${SPACING_UNIT}em;\n  }\n`;\n\nconst Price = styled.span`\n  font-size: 1.25em;\n  font-weight: bold;\n`;\n\nexport function TripCard({ trip }) {\n  const departureDate = parse(trip.departure_date, DATE_API_FORMAT, TODAY);\n  let formattedDepartureTime = format(departureDate, TIME_FORMAT);\n\n  if (!isSameDay(departureDate, TODAY)) {\n    const day = format(departureDate, DAY_FORMAT);\n    formattedDepartureTime = `${formattedDepartureTime} - ${day}`;\n  }\n\n  return (\n    <Card>\n      <CardContent>\n        <TripInfo>\n          <DepartureDate>{formattedDepartureTime}</DepartureDate>\n\n          <span>\n            {trip.departure_place.city_name} - {trip.arrival_place.city_name}\n          </span>\n        </TripInfo>\n\n        <Price>{trip.price.string_value}</Price>\n      </CardContent>\n\n      <CardFooter>\n        <UserInfo user={trip.user} />\n\n        <a href={trip.links._front} target=\"_blank\" rel=\"noopener noreferrer\">\n          See more on BlaBlaCar\n        </a>\n      </CardFooter>\n    </Card>\n  );\n}\n\nTripCard.propTypes = {\n  trip: PropTypes.shape({\n    departure_date: PropTypes.string.isRequired,\n    departure_place: PropTypes.shape({ city_name: PropTypes.string.isRequired })\n      .isRequired,\n    arrival_place: PropTypes.shape({ city_name: PropTypes.string.isRequired })\n      .isRequired,\n    price: PropTypes.shape({\n      string_value: PropTypes.string.isRequired,\n    }).isRequired,\n    user: PropTypes.object.isRequired,\n    links: PropTypes.shape({\n      _front: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport {\n  CHILDREN_SPACING_SELECTOR,\n  SECONDARY_TEXT_COLOR,\n  SPACING_UNIT,\n} from '../styles';\nimport { TripCard } from './TripCard';\n\nconst Results = styled.ul`\n  list-style: none;\n  margin: 0;\n  padding: 0;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-top: ${SPACING_UNIT * 3}em;\n  }\n`;\n\nconst ResultsCount = styled.p`\n  color: ${SECONDARY_TEXT_COLOR};\n`;\n\nexport function SearchResults({ results: { pager, trips } }) {\n  return (\n    <section>\n      <ResultsCount>Found {pager.total} results</ResultsCount>\n\n      <Results>\n        {trips.map(trip => (\n          <li key={trip.permanent_id}>\n            <TripCard trip={trip} />\n          </li>\n        ))}\n      </Results>\n    </section>\n  );\n}\n\nSearchResults.propTypes = {\n  results: PropTypes.object.isRequired,\n};\n","import { stringify } from 'query-string';\n\nconst DEFAULT_SEARCH_QUERIES = {\n  _format: 'json',\n  locale: 'fr_FR',\n  cur: 'EUR',\n};\n\nconst DEFAULT_SEARCH_OPTIONS = {\n  headers: {\n    Accept: 'application/json',\n    'Accept-Language': 'fr',\n    'cache-control': 'no-cache',\n  },\n};\n\nexport async function searchTrips({ departure, destination, fetchAPI }) {\n  const query = stringify({\n    ...DEFAULT_SEARCH_QUERIES,\n    fn: departure,\n    tn: destination,\n  });\n\n  const result = await fetchAPI(\n    `${process.env.REACT_APP_TRIP_API}?${query}`,\n    DEFAULT_SEARCH_OPTIONS,\n  );\n\n  if (!result.ok) {\n    throw new Error(\n      `Could not search trips: ${result.statusText || result.status}`,\n    );\n  }\n\n  return await result.json();\n}\n","import React from 'react';\nimport { useAsyncMemo } from 'react-behave';\nimport styled from 'styled-components/macro';\nimport { useAPI } from '../api/useAPI';\nimport { SECONDARY_TEXT_COLOR } from '../styles';\nimport { SearchForm } from './SearchForm';\nimport { SearchResults } from './SearchResults';\nimport { searchTrips } from './searchTrips';\n\nconst Separator = styled.hr`\n  margin: 0;\n  border: none;\n  border-top: 1px solid #eee;\n`;\n\nconst Helper = styled.p`\n  text-align: center;\n  color: ${SECONDARY_TEXT_COLOR};\n`;\n\nconst Placeholder = styled.p`\n  color: ${SECONDARY_TEXT_COLOR};\n`;\n\nexport function Search() {\n  const { fetchAPI } = useAPI();\n\n  const [departure, setDeparture] = React.useState('');\n  const [destination, setDestination] = React.useState('');\n\n  const [results, searchStatus] = useAsyncMemo(async () => {\n    if (departure === '' || destination === '') {\n      return null;\n    }\n\n    return await searchTrips({ departure, destination, fetchAPI });\n  }, [departure, destination, fetchAPI]);\n\n  let content = null;\n\n  if (departure === '' || destination === '') {\n    content = <Helper>Enter a departure and destination city above</Helper>;\n  } else if (searchStatus.error != null) {\n    content = <p>{searchStatus.error.message}</p>;\n  } else if (searchStatus.pending) {\n    // We sould use a nive placeholder here instead of some text.\n    content = <Placeholder>Loading...</Placeholder>;\n  } else if (results != null) {\n    content = <SearchResults results={results} />;\n  }\n\n  return (\n    <>\n      <SearchForm\n        departure={departure}\n        setDeparture={setDeparture}\n        destination={destination}\n        setDestination={setDestination}\n      />\n\n      <Separator />\n      {content}\n    </>\n  );\n}\n","import React from 'react';\nimport { API_CONTEXT } from './apiContext';\n\nexport function useAPI() {\n  const context = React.useContext(API_CONTEXT);\n\n  if (context == null) {\n    throw new Error('useAPI cannot be used outside of an <APIProvider />');\n  }\n\n  return context;\n}\n","import React from 'react';\nimport styled, { createGlobalStyle } from 'styled-components/macro';\nimport { APIProvider } from '../api/APIProvider';\nimport { Search } from '../search/Search';\nimport {\n  CHILDREN_SPACING_SELECTOR,\n  PRIMARY_TEXT_COLOR,\n  SPACING_UNIT,\n} from '../styles';\n\nconst GlobalStyles = createGlobalStyle`\n  *,\n  *::before,\n  *::after {\n    box-sizing: border-box;\n  }\n\n  body {\n    margin: 0;\n    display: flex;\n    flex-direction: column;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    font-size: 16px;\n    color: ${PRIMARY_TEXT_COLOR};\n  }\n`;\n\nconst AppWrapper = styled.main`\n  margin: 0 auto;\n  width: 90%;\n  max-width: 960px;\n  padding: ${SPACING_UNIT * 4}em 0;\n\n  ${CHILDREN_SPACING_SELECTOR} {\n    margin-top: ${SPACING_UNIT * 4}em;\n  }\n`;\n\nconst Title = styled.h1`\n  margin: 0;\n  font-size: 3em;\n  font-weight: normal;\n`;\n\nexport function App() {\n  return (\n    <AppWrapper>\n      <GlobalStyles />\n\n      <Title>Find a trip</Title>\n\n      <APIProvider>\n        <Search />\n      </APIProvider>\n    </AppWrapper>\n  );\n}\n","export * from './App';\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\nimport { ErrorBoundary } from './ErrorBoundary';\n\nglobal.APP_VERSION = process.env.REACT_APP_VERSION;\nglobal.APP_NAME = process.env.REACT_APP_NAME;\n\nReactDOM.render(\n  <React.StrictMode>\n    <ErrorBoundary>\n      <App />\n    </ErrorBoundary>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}